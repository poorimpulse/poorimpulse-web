mixin person(contributor)
  - if(!contributor)
    | Anonymous
  - else if (contributor.displayname)  // This is a supporter
    - if(contributor.link)
      a(href=contributor.link)= contributor.displayname
    - else
      = contributor.displayname
  - else
    - if(contributor.urlforwhereyournameshouldlinkto)
      a(href=contributor.urlforwhereyournameshouldlinkto)
         = contributor.howwouldyoulikeyournametoappearinthepodcastepisodenotes
    - else
      = contributor.howwouldyoulikeyournametoappearinthepodcastepisodenotes

 mixin avatar(contributor, size)
  - var url = 'http://www.gravatar.com/avatar/x?d=monsterid'
  if (contributor)
    - url = contributor.gravatarurl
  img(src='#{url}&s=#{size}')

mixin audio(episode)
  audio(controls preload='none')
    source(src=episode.audio_url type='audio/mpeg')
    | mp3 not supported by your browser, subscribe to listen

mixin playset(episode)
  - if(episode.playset)
    .playset
      | This podcast story was generated by playing&nbsp;
      a(href='http://www.bullypulpitgames.com/games/fiasco/') Fiasco
      |  using the playset&nbsp;
      a(href=episode.playset.url)= episode.playset.name
      | .

mixin credit(shortname, credit)
  - var person = contributors[shortname]
  .person
    .avatar
      +avatar(person, 42)
    .name
      +person(person)
    .credit= credit

mixin contributor(shortname, episodes)
  - var person = contributors[shortname]
  .avatar
    +avatar(person, 128)
  .person
    +person(person)
  .episodes
    each episode, idx in episodes
      - if(idx !== 0)
        | ,&nbsp;
      a(href=episode.permalink) #{episode.guid}. #{episode.title}

mixin contributors(list)
  ul.contributor-list.person-list
    - var keys = Object.keys(list).sort()
    each key in keys
      li
        +contributor(key, list[key])

mixin supporter(shortname, filter)
  - var person = supporters[shortname]
  if person[filter] === 'Yes'
    li
      +_supporter(person)

mixin _supporter(person)
  .person
    +person(person)
